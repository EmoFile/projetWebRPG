{% extends 'base.html' %}
{% block table-score %}
    <div class="row container-fluid">
        <div class="col-5">
            <span id="characterPk" hidden>{{ party.character.pk }}</span>
            <table>
                <thead>
                <tr>
                    <th scope="col">
                        <span id="characterName">{{ party.character.name }}</span>
                    </th>
                    <th scope="col">
                        <span id="characterClass">{{ party.character.characterClass.name }}</span>
                    </th>
                    <th scope="col">
                        Lvl: <span class="inline" id="characterLevel">{{ party.character.level }}</span></th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th scope="row">XP:</th>
                    <td>
                        <span id="characterXp">{{ currentCharacter.xp }}</span>/
                        <span id="characterXpRequired">{{ currentCharacter.xpRequired }}</span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-success">HP:</th>
                    <td>
                        <span id="characterHp">{{ currentCharacter.hp }}</span>/
                        <span id="characterHpMax">{{ currentCharacter.hpMax }}</span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-primary">ARM:</th>
                    <td>
                        <span id="characterPhysicalResistence">{{ party.character.getPhysicalResistance }}</span>
                        <span id="characterBasicPhysicalResistence">({{ party.character.physicalResistance }})</span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-secondary">RES:</th>
                    <td><span
                        id="characterMagicalResistence">
                        {{ party.character.getMagicalResistance }}</span>
                        <span
                            id="characterBasicMagicalResistence">({{ party.character.magicalResistance }})</span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-danger">STR:</th>
                    <td><span
                        id="characterStrength">
                        {{ party.character.getStrength }}</span>
                        <span
                            id="characterBasicStrength">({{ party.character.strength }})</span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-info">INT:</th>
                    <td><span
                        id="characterIntelligence">
                        {{ party.character.getIntelligence }}</span>
                        <span
                            id="characterBasicIntelligence">({{ party.character.intelligence }})</span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-warning">AGI:</th>
                    <td><span
                        id="characterAgility">
                        {{ party.character.getAgility }}</span>
                        <span
                            id="characterBasicAgility">({{ party.character.agility }})</span>
                    </td>
                </tr>
                </tbody>
            </table>

            <div>
                <div>
                    {% if party.character.inventory.head != Null %}
                        <table class="table table-borderless">
                            <tr class="small">
                                <th scope="row" id="headKind"><span>Helmet</span>
                                </th>
                                {% if party.character.inventory.head.rarity == 'Rare' %}
                                    <td>
                                        <span id="headName"
                                              style="color: dodgerblue">{{ party.character.inventory.head.name }}</span>
                                    </td>
                                {% elif party.character.inventory.head.rarity == 'Epic' %}
                                    <td>
                                        <span id="headName"
                                              style="color: blueviolet">{{ party.character.inventory.head.name }}</span>
                                    </td>
                                {% elif party.character.inventory.head.rarity == 'Legendary' %}
                                    <td>
                                        <span id="headName"
                                              style="color: gold">{{ party.character.inventory.head.name }}</span>
                                    </td>
                                {% else %}
                                    <td>
                                        <span id="headName"
                                              style="color: limegreen">{{ party.character.inventory.head.name }}</span>
                                    </td>
                                {% endif %}
                                <td>
                                    <span id="headHpMax"
                                          class="text-success">{{ party.character.inventory.head.hpMax }}</span>
                                </td>
                                <td>
                                    <span id="headPhysicalResistance"
                                          class="text-primary">{{ party.character.inventory.head.physicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="headMagicalResistance"
                                          class="text-secondary">{{ party.character.inventory.head.magicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="headStrength"
                                          class="text-danger">{{ party.character.inventory.head.strength }}</span>
                                </td>
                                <td>
                                    <span id="headIntelligence"
                                          class="text-info">{{ party.character.inventory.head.intelligence }}</span>
                                </td>
                                <td>
                                    <span id="headAgility"
                                          class="text-warning">{{ party.character.inventory.head.agility }}</span>
                                </td>
                            </tr>
                        </table>
                    {% else %}
                        <table class="table table-borderless">
                            <tr class="small">
                                <th scope="row"><span id="headKind">Head</span>
                                </th>
                                <td scope="row"><span id="headName">No helmet</span></td>
                                <td>
                                    <span id="headHpMax"
                                          class="text-success"></span>
                                </td>
                                <td>
                                    <span id="headPhysicalResistance"
                                          class="text-primary"></span>
                                </td>
                                <td>
                                    <span id="headMagicalResistance"
                                          class="text-secondary"></span>
                                </td>
                                <td>
                                    <span id="headStrength"
                                          class="text-danger"></span>
                                </td>
                                <td>
                                    <span id="headIntelligence"
                                          class="text-info"></span>
                                </td>
                                <td>
                                    <span id="headAgility"
                                          class="text-warning"></span>
                                </td>
                            </tr>
                        </table>
                    {% endif %}
                </div>

                <div>
                    {% if party.character.inventory.chest != Null %}
                        <table class="table table-borderless">
                            <tr class="small">
                                <th scope="row" id="chestKind"><span>Chest</span>
                                </th>
                                {% if party.character.inventory.chest.rarity == 'Rare' %}
                                    <td>
                                        <span id="chestName"
                                              style="color: dodgerblue">{{ party.character.inventory.chest.name }}</span>
                                    </td>
                                {% elif party.character.inventory.chest.rarity == 'Epic' %}
                                    <td>
                                        <span id="chestName"
                                              style="color: blueviolet">{{ party.character.inventory.chest.name }}</span>
                                    </td>
                                {% elif party.character.inventory.chest.rarity == 'Legendary' %}
                                    <td>
                                        <span id="chestName"
                                              style="color: gold">{{ party.character.inventory.chest.name }}</span>
                                    </td>
                                {% else %}
                                    <td>
                                        <span id="chestName"
                                              style="color: limegreen">{{ party.character.inventory.chest.name }}</span>
                                    </td>
                                {% endif %}
                                <td>
                                    <span id="chestHpMax"
                                          class="text-success">{{ party.character.inventory.chest.hpMax }}</span>
                                </td>
                                <td>
                                    <span id="chestPhysicalResistance"
                                          class="text-primary">{{ party.character.inventory.chest.physicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="chestMagicalResistance"
                                          class="text-secondary">{{ party.character.inventory.chest.magicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="chestStrength"
                                          class="text-danger">{{ party.character.inventory.chest.strength }}</span>
                                </td>
                                <td>
                                    <span id="chestIntelligence"
                                          class="text-info">{{ party.character.inventory.chest.intelligence }}</span>
                                </td>
                                <td>
                                    <span id="chestAgility"
                                          class="text-warning">{{ party.character.inventory.chest.agility }}</span>
                                </td>
                            </tr>
                        </table>
                    {% else %}
                        <table class="table table-borderless">
                            <tr class="small">
                                <th scope="row"><span id="chestKind">Chest</span>
                                </th>

                                <td scope="row"><span id="chestName">No breathplate</span>
                                </td>
                                <td>
                                    <span id="chestHpMax"
                                          class="text-success">{{ party.character.inventory.chest.hpMax }}</span>
                                </td>
                                <td>
                                    <span id="chestPhysicalResistance"
                                          class="text-primary">{{ party.character.inventory.chest.physicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="chestMagicalResistance"
                                          class="text-secondary">{{ party.character.inventory.chest.magicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="chestStrength"
                                          class="text-danger">{{ party.character.inventory.chest.strength }}</span>
                                </td>
                                <td>
                                    <span id="chestIntelligence"
                                          class="text-info">{{ party.character.inventory.chest.intelligence }}</span>
                                </td>
                                <td>
                                    <span id="chestAgility"
                                          class="text-warning">{{ party.character.inventory.chest.agility }}</span>
                                </td>
                            </tr>
                        </table>
                    {% endif %}
                </div>

                <div>
                    {% if party.character.inventory.leg != Null %}
                        <table class="table table-borderless">
                            <tr class="small">
                                <th scope="row" id="legKind"><span>Leg</span>
                                </th>
                                {% if party.character.inventory.leg.rarity == 'Rare' %}
                                    <td>
                                        <span id="legName"
                                              style="color: dodgerblue">{{ party.character.inventory.leg.name }}</span>
                                    </td>
                                {% elif party.character.inventory.leg.rarity == 'Epic' %}
                                    <td>
                                        <span id="legName"
                                              style="color: blueviolet">{{ party.character.inventory.leg.name }}</span>
                                    </td>
                                {% elif party.character.inventory.leg.rarity == 'Legendary' %}
                                    <td>
                                        <span id="legName"
                                              style="color: gold">{{ party.character.inventory.leg.name }}</span>
                                    </td>
                                {% else %}
                                    <td>
                                        <span id="legName"
                                              style="color: limegreen">{{ party.character.inventory.leg.name }}</span>
                                    </td>
                                {% endif %}
                                <td>
                                <span id="legHpMax"
                                      class="text-success">{{ party.character.inventory.leg.hpMax }}</span>
                                </td>
                                <td>
                                    <span id="legPhysicalResistance"
                                          class="text-primary">{{ party.character.inventory.leg.physicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="legMagicalResistance"
                                          class="text-secondary">{{ party.character.inventory.leg.magicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="legStrength"
                                          class="text-danger">{{ party.character.inventory.leg.strength }}</span>
                                </td>
                                <td>
                                    <span id="legIntelligence"
                                          class="text-info">{{ party.character.inventory.leg.intelligence }}</span>
                                </td>
                                <td>
                                    <span id="legAgility"
                                          class="text-warning">{{ party.character.inventory.leg.agility }}</span>
                                </td>
                            </tr>
                        </table>
                    {% else %}
                        <table class="table table-borderless">
                            <tr class="small">
                                <th scope="row" id="legKind"><span>Leg</span>
                                </th>
                                <td scope="row"><span id="legName">No leg</span></td>
                                <td>
                                    <span id="legHpMax"
                                          class="text-success">{{ party.character.inventory.leg.hpMax }}</span>
                                </td>
                                <td>
                                    <span id="legPhysicalResistance"
                                          class="text-primary">{{ party.character.inventory.leg.physicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="legMagicalResistance"
                                          class="text-secondary">{{ party.character.inventory.leg.magicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="legStrength"
                                          class="text-danger">{{ party.character.inventory.leg.strength }}</span>
                                </td>
                                <td>
                                    <span id="legIntelligence"
                                          class="text-info">{{ party.character.inventory.leg.intelligence }}</span>
                                </td>
                                <td>
                                    <span id="legAgility"
                                          class="text-warning">{{ party.character.inventory.leg.agility }}</span>
                                </td>
                            </tr>
                        </table>
                    {% endif %}
                </div>
                <div>
                    {% if party.character.inventory.weapon != Null %}
                        <table class="table table-borderless">
                            <tr class="small">
                                <th scope="row" id="weaponKind"><span>Weapon</span>
                                </th>
                                {% if party.character.inventory.weapon.rarity == 'Rare' %}
                                    <td>
                                        <span id="weaponName"
                                              style="color: dodgerblue">{{ party.character.inventory.weapon.name }}</span>
                                    </td>
                                {% elif party.character.inventory.weapon.rarity == 'Epic' %}
                                    <td>
                                        <span id="weaponName"
                                              style="color: blueviolet">{{ party.character.inventory.weapon.name }}</span>
                                    </td>
                                {% elif party.character.inventory.weapon.rarity == 'Legendary' %}
                                    <td>
                                        <span id="weaponName"
                                              style="color: gold">{{ party.character.inventory.weapon.name }}</span>
                                    </td>
                                {% else %}
                                    <td>
                                        <span id="weaponName"
                                              style="color: limegreen">{{ party.character.inventory.weapon.name }}</span>
                                    </td>
                                {% endif %}
                                <td>
                                    <span class="text-black small">
                                        <span
                                            id="weaponDiceNumber">{{ party.character.inventory.weapon.diceNumber }}</span>D<span
                                        id="weaponDamage">{{ party.character.inventory.weapon.damage }}</span>
                                    </span>
                                </td>
                                <td>
                                    <span id="weaponHpMax"
                                          class="text-success">{{ party.character.inventory.weapon.hpMax }}</span>
                                </td>
                                <td>
                                    <span id="weaponPhysicalResistance"
                                          class="text-primary">{{ party.character.inventory.weapon.physicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="weaponMagicalResistance"
                                          class="text-secondary">{{ party.character.inventory.weapon.magicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="weaponStrength"
                                          class="text-danger">{{ party.character.inventory.weapon.strength }}</span>
                                </td>
                                <td>
                                    <span id="weaponIntelligence"
                                          class="text-info">{{ party.character.inventory.weapon.intelligence }}</span>
                                </td>
                                <td>
                                    <span id="weaponAgility"
                                          class="text-warning">{{ party.character.inventory.weapon.agility }}</span>
                                </td>
                            </tr>
                        </table>
                    {% else %}
                        <table class="table table-borderless">
                            <tr class="small">
                                <th scope="row" id="weaponKind"><span>Weapon</span>
                                </th>
                                <td scope="row"><span id="weaponName">No weapon</span>
                                </td>
                                <td>
                                    <span id="weaponHpMax"
                                          class="text-success">{{ party.character.inventory.weapon.hpMax }}</span>
                                </td>
                                <td>
                                    <span id="weaponPhysicalResistance"
                                          class="text-primary">{{ party.character.inventory.weapon.physicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="weaponMagicalResistance"
                                          class="text-secondary">{{ party.character.inventory.weapon.magicalResistance }}</span>
                                </td>
                                <td>
                                    <span id="weaponStrength"
                                          class="text-danger">{{ party.character.inventory.weapon.strength }}</span>
                                </td>
                                <td>
                                    <span id="weaponIntelligence"
                                          class="text-info">{{ party.character.inventory.weapon.intelligence }}</span>
                                </td>
                                <td>
                                    <span id="weaponAgility"
                                          class="text-warning">{{ party.character.inventory.weapon.agility }}</span>
                                </td>
                            </tr>
                        </table>
                    {% endif %}
                </div>
            </div>
            <div>
                <div id="consumablesPanel">
                    {#                    {% if party.character.inventory.consumables != Null %}#}
                    {% if party.character.inventory.inventoryconsumable_set.all != 0 %}
                        {% for consumable in party.character.inventory.inventoryconsumable_set.all %}
                            <table class="table table-borderless" id="{{ consumable.consumable.name }}">
                                <tr class="small">
                                    {% if consumable.consumable.rarity == 'Rare' %}
                                        <th scope="row" style="color: dodgerblue">{{ consumable.consumable.name }}</th>
                                    {% elif consumable.consumable.rarity == 'Epic' %}
                                        <th scope="row" style="color: blueviolet">{{ consumable.consumable.name }}</th>
                                    {% elif pconsumable.consumable.rarity == 'Legendary' %}
                                        <th scope="row" style="color: gold">{{ consumable.consumable.name }}</th>
                                    {% else %}
                                        <th scope="row" style="color: limegreen">{{ consumable.consumable.name }}</th>
                                    {% endif %}
                                    <td>
                                            <span
                                                id="quantity/{{ party.pk }}/{{ consumable.consumable.pk }}">{{ consumable.quantity }}</span>
                                    </td>
                                    <td>
                                        <button type="button"
                                                urlUseItem="quantity/{{ party.pk }}/{{ consumable.consumable.pk }}"
                                                coupleCharacterConsumable="{{ party.pk }}/{{ consumable.consumable.pk }}"
                                                class="useItem btn btn-success">
                                            Use
                                        </button>
                                    </td>
                                    <td>
                                        <table>
                                            <tr>
                                                <th>
                                                    <span id="hp/{{ party.pk }}/{{ consumable.consumable.pk }}"
                                                          class="col-3 text-success">{{ consumable.consumable.hp }}</span>
                                                </th>
                                                <th>
                                                    <span id="strength/{{ party.pk }}/{{ consumable.consumable.pk }}"
                                                          class="col-3 text-danger">{{ consumable.consumable.strength }}</span>
                                                </th>
                                                <th>
                                                    <span
                                                        id="intelligence/{{ party.pk }}/{{ consumable.consumable.pk }}"
                                                        class="col-3 text-info">{{ consumable.consumable.intelligence }}</span>
                                                </th>
                                                <th>
                                                    <span id="agility/{{ party.pk }}/{{ consumable.consumable.pk }}"
                                                          class="col-3 text-warning">{{ consumable.consumable.agility }}</span>
                                                </th>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        {% endfor %}
                    {% else %}
                        No consumable
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-5">
            <div>
                <span class="h1">Stage: </span>
                <span id="stage" class="h1">{{ enemy.partyStage }}</span>
            </div>
            <div>
                <span id="buttonPlayRound"></span>
                <span id="buttonRollDice"></span>
                <span id="buttonNextStage"></span>
            </div>
            <div class="battleReport">
            </div>
        </div>
        <div class="col-2">
            <p id="pkEnemy" hidden>{{ enemy.enemyPk }}</p>
            <table>
                <thead>
                <tr>
                    <th scope="col">
                        <span id="enemyName">{{ enemy.enemyName }}</span>
                    </th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th scope="row" class="text-success">HP:</th>
                    <td>
                        <span>
                            <span id="enemyHp"> {{ enemy.enemyHp }}</span>
                            <span>/</span>
                            <span id="enemyHpMax">{{ enemy.enemyHpMax }}</span>
                        </span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-primary">
                        ARM:
                    </th>
                    <td>
                        <span id="enemyPhysicalResistance">
                            {{ enemy.enemyPhysicalResistance }}
                        </span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-secondary">
                        RES:
                    </th>
                    <td>
                        <span id="enemyMagicalResistance">
                            {{ enemy.enemyMagicalResistance }}
                        </span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-danger">
                        STR:
                    </th>
                    <td>
                        <span id="enemyStrength">
                            {{ enemy.enemyStrength }}
                        </span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-info">
                        INT:
                    </th>
                    <td>
                        <span id="enemyIntelligence">
                            {{ enemy.enemyIntelligence }}
                        </span>
                    </td>
                </tr>
                <tr>
                    <th scope="row" class="text-warning">
                        AGI:
                    </th>
                    <td>
                        <span id="enemyAgility">
                            {{ enemy.enemyAgility }}
                        </span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="itemModal" tabindex="-1" role="dialog"
         aria-labelledby="itemModalLabel"
         aria-hidden="true" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="itemModalLabel">Modal
                        title</h5>
                </div>
                <div class="modal-body" id="itemModalBody">
                    <p id="levelRequired"></p>
                    <p id="classRequired"></p>
                    <p id="stuffKindName"></p>
                    <p id="rarity"></p>
                    <p id="damage"></p>
                    <p id="hpMax"></p>
                    <p id="hp"></p>
                    <p id="physicalResistence"></p>
                    <p id="magicalResistence"></p>
                    <p id="strength"></p>
                    <p id="intelligence"></p>
                    <p id="agility"></p>
                    <p id="stuffClassName" hidden></p>
                    <p id="stuffPk" hidden></p>
                </div>
                <div class="modal-footer">
                    <button type="button" id="closeModal" class="btn btn-secondary" data-dismiss="modal">Pass</button>
                    <button type="button" id="changeItem" class="btn btn-primary">Keep</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="isEndedModal" tabindex="-1" role="dialog"
         aria-labelledby="endModalLabel"
         aria-hidden="true" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="endModalLabel">GAME OVER</h5>
                </div>
                <div class="modal-body text-center" id="endModalBody">
                    <p>Global rank: <span id="endRank"></span></p>
                    <p>Personal rank: <span id="endRankPersonal"></span></p>
                    <table class="table table-striped">
                        <thead class="thead-dark">
                        <tr>
                            <th scope="col">Character</th>
                            <th scope="col">Stage</th>
                            <th scope="col">Class</th>
                            <th scope="col">HP Max</th>
                            <th scope="col">Strength</th>
                            <th scope="col">Intelligence</th>
                            <th scope="col">Agility</th>
                            <th scope="col">Physical resistance</th>
                            <th scope="col">Magical resistance</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td id="endCharacterName"></td>
                            <td id="endStage"></td>
                            <td id="endCharacterClass"></td>
                            <td id="endHpMax"></td>
                            <td id="endStrength"></td>
                            <td id="endIntelligence"></td>
                            <td id="endAgility"></td>
                            <td id="endPhysicalResistance"></td>
                            <td id="endMagicalResistance"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Pass</button>
                    <a class="btn btn-primary" href="{% url 'home' %}" role="button">
                        Home page
                    </a>
                    <a class="btn btn-success"
                       href="{% url 'generateCharacterByPk' party.character.characterClass.pk %}" role="button">
                        Retry
                    </a>

                </div>
            </div>
        </div>
    </div>
{% endblock %}